webpackJsonp([7],{1106:function(t,e,a){"use strict";function i(t){a(1132)}Object.defineProperty(e,"__esModule",{value:!0});var s=a(1135),n=a.n(s),r=a(1136),l=a(15),o=i,d=l(n.a,r.a,!1,o,"data-v-1f39b00b",null);e.default=d.exports},1132:function(t,e,a){var i=a(1133);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(1103)("57cab30f",i,!0)},1133:function(t,e,a){e=t.exports=a(1102)(!1),e.i(a(1134),""),e.push([t.i,".modal .table-common[data-v-1f39b00b]{width:100%}",""])},1134:function(t,e,a){e=t.exports=a(1102)(!1),e.push([t.i,".top-notice{padding:4px 2px;margin-bottom:12px}.twoselect{height:35px}.twoselect select{width:115px;float:right;margin-left:30px;height:28px}.position .pas-table-dropdown .dropdown-area{height:auto}",""])},1135:function(module,exports,__webpack_require__){"use strict";(function($){Object.defineProperty(exports,"__esModule",{value:!0});var _vuex=__webpack_require__(229),moduleName="positionAnalysis",awkwardnessGrid=null,heavyIndustryGrid=null,positionAnalysisChartData=null,utils=$.pasUtils(),common=$.common(),_self;exports.default={name:"positionAnalysis",data:function(){return{detailbutGrid:null,selectedIndustry:"Industry one",selectedBench:"FKBch~000300SH",benchLabel:"沪深300(仓位)",activated:!0,loading1:null,loading2:null,loading3:null,loading4:null}},computed:(0,_vuex.mapState)(moduleName,{awkwardness:function(t){return t.awkwardness},heavyIndustry:function(t){return t.heavyIndustry},detailbut:function(t){return t.detailbut},industrysel:function(t){return t.industrysel},namesel:function(t){return t.namesel},echartConfig:function(t){return t.echartConfig}}),mounted:function(){_self=this,this.loadData(),this.bindListenerOnModal()},activated:function(){this.activated=!0,this.chart&&this.chart.length>0&&this.chart.forEach(function(t){setTimeout(t.resize,0)})},deactivated:function(){this.activated=!1},destroyed:function(){this.destroy(),$(".OG-cell-options").remove()},methods:{loadData:function(t){var t=t||this.$store.state.selectGroup.id;this.destroy(),$(".OG-cell-options").remove(),this.awkwardnessFun(t),this.heavyIndustryFun(t),this.reportEchartData(t),$(".positiondrag").is(":visible")&&this.initDataDetailbut.call(this,t,this.selectedIndustry,this.selectedBench),this.$store.commit(moduleName+"/initAwkwardness"),this.$store.commit(moduleName+"/initHeavyIndustry")},destroy:function(){(awkwardnessGrid||heavyIndustryGrid||this.detailbutGrid)&&(awkwardnessGrid.kill(),heavyIndustryGrid.kill(),this.detailbutGrid&&this.detailbutGrid.kill())},change:function(t,e){if("Bench"==e){var a=$(t.currentTarget).find("option:selected").text();this.benchLabel=a+"(仓位)"}else{var i=this.$store.state.selectGroup.id;this.$store.commit(moduleName+"/initDetailbut"),this.detailbutGrid&&this.detailbutGrid.kill(),this.initDataDetailbut.call(this,i,this.selectedIndustry,this.selectedBench)}},initDataDetailbut:function(t,e,a){this.loading4=!0,this.detailbutGrid=og.views.analytics.griddata.loadGridData({name:og.api.rest.views.parame.positionAnalysis.detailbut,requestParam:{aggregators:e?[e,"Security Name"]:["Industry one","Security Name"],portfolio:t||this.$store.state.selectGroup.id,benchId:a||this.selectedBench||"FKBch~000300SH"},otherParam:{visibleArea:utils.getVisibleArea(".detail_table"),isDepgraph:!0},metaHandle:function(t){_self.$store.commit({type:moduleName+"/setDetailbut",newVal:t}),_self.detailbut.splice(t.length)},dataHandle:this.handleDetailbutData})},handleDetailbutData:function(t){if($.isArray(t))for(var e=t[1],a=t[2],i=0;i<a.length;i++){var s=a[i].cells,n={};n.name=e[i].cells[0].dataRow+e[i].cells[0].value,n.securityId=e[i].cells[0].securityId;for(var r=0;r<s.length;r++){var l=s[r].col_name;n[l]=s[r]}this.$set(this.detailbut,a[i].data_row,n)}this.loading4=!1,this.$nextTick(function(){new com.hundsun.pas.common.gadgets.CellMenu('table[tabid="detail-table"] tr td[cell]',_self.detailbutGrid)})},awkwardnessFun:function(t){this.loading1=!0;awkwardnessGrid=og.views.analytics.griddata.loadGridData({name:og.api.rest.views.parame.positionAnalysis.awkwardness,requestParam:{portfolio:t},otherParam:{visibleArea:{height:155,width:1e3,scrollHeight:0,scrollWidth:0,scrollTop:0,scrollLeft:0},isDepgraph:!0},metaHandle:null,dataHandle:this.handleAwkwardnessData})},handleAwkwardnessData:function(t){if($.isArray(t))for(var e=t[1],a=t[2],i=1;i<a.length;i++){var s=a[i].cells,n={},r=e[i].cells[0];n.name=r.value,n.securityId=r.securityId;for(var l=0;l<s.length;l++){var o=s[l].col_name;n[o]=s[l]}this.$set(this.awkwardness,i-1,n)}this.loading1=!1,this.$nextTick(function(){new com.hundsun.pas.common.gadgets.CellMenu('table[tabid="awkwardness"] tr td[cell]',awkwardnessGrid)})},heavyIndustryFun:function(t){this.loading2=!0;heavyIndustryGrid=og.views.analytics.griddata.loadGridData({name:og.api.rest.views.parame.positionAnalysis.heavyIndustry,requestParam:{portfolio:t},otherParam:{visibleArea:{height:155,width:1e3,scrollHeight:0,scrollWidth:0,scrollTop:0,scrollLeft:0},isDepgraph:!0},metaHandle:null,dataHandle:this.handleHeavyIndustryData})},handleHeavyIndustryData:function(t){if($.isArray(t))for(var e=t[1],a=t[2],i=1;i<a.length;i++){var s=a[i].cells,n={};n.name=e[i].cells[0].value,n.securityId=e[i].cells[0].securityId;for(var r=0;r<s.length;r++){var l=s[r].col_name;n[l]=s[r]}this.$set(this.heavyIndustry,i-1,n)}this.loading2=!1,this.$nextTick(function(){new com.hundsun.pas.common.gadgets.CellMenu('table[tabid="heavyIndustry"] tr td[cell]',heavyIndustryGrid)})},bindListenerOnModal:function(){$(".positiondrag").on("shown.bs.modal",function(){_self.detailBtnClick()}),$(".positiondrag").on("hide.bs.modal",function(){$(".OG-cell-options").hide()})},detailBtnClick:function(){this.$store.commit(moduleName+"/initDetailbut");var t=this.$store.state.selectGroup.id;this.detailbutGrid&&this.detailbutGrid.kill(),this.initDataDetailbut.call(this,t,this.selectedIndustry,this.selectedBench),$(".OG-cell-options").hide()},reportEchartData:function(t){this.loading3=!0,positionAnalysisChartData=og.views.analytics.griddata.loadChartData({name:og.api.rest.views.parame.positionAnalysis.reportEchartData,requestParam:{portfolio:t},otherParam:{lineNum:2},titleHandle:this.loadTitleData,dataHandle:this.loadLineData})},loadTitleData:function(t){this.chart[0].setOption({legend:{data:["沪深300点位",t+"股票仓位"]},series:[{name:"沪深300点位"},{name:t+"股票仓位"}]})},loadLineData:function(t){if(t instanceof Object){var e=t.timeseries.data.length,a=new Array(e),i=new Array(e);t.timeseries.data.reduce(function(t,e,a){return null==e?t:(t.$time[a]=new Date(e[0]).Format("yyyy-MM-dd"),t.$value[a]=e[1],t)},{$time:a,$value:i}),this.chart[0].setOption({xAxis:[{data:a}]});var s=this;setTimeout(function(){var e,a,n;2==t.num?(e=Math.max.apply(Math,i),a=Math.min.apply(Math,i),n=(e-a)/5,s.chart[0].setOption({yAxis:[{max:e,min:a,interval:n},{}],series:[{data:i},{}]})):(e=Math.max.apply(Math,i),a=Math.min.apply(Math,i),n=(e-a)/5,s.chart[0].setOption({yAxis:[{},{max:e,min:a,interval:n}],series:[{},{data:i}]}))},200)}this.loading3=!1},getLastVisit:function(){var t=utils.getPortfolio(),e=t.id;this.awkwardnessFun(e),this.heavyIndustryFun(e),this.initDataDetailbut(e),this.reportEchartData(e)},addVisit:function addVisit(event){var $target=$(event.currentTarget),_$start=$target.attr("data-row"),_$end=$target.attr("data-splice");if(_$start&&_$end){this.detailbutGrid.busy(!0);for(var _$$start=parseInt(_$start),_$$end=parseInt(_$end),empty=[],$itemSplice="this.detailbut.splice(_$$start+1,_$$end-_$$start",i=0;i<_$$end-_$$start;i++)$itemSplice=$itemSplice.concat(",empty");return $itemSplice+=")",eval("("+$itemSplice+")"),void(this.detailbutGrid.resize(_$start)&&this.detailbutGrid.busy(!1))}if(/data-row/g.test($target.html())){var target=$target.html();if(target.indexOf("node collapse")>0||target.indexOf("node expand")>0){$target=$(target.replace(/&nbsp;/g,"")),_$start=$target.attr("data-row"),_$end=$target.attr("data-splice"),this.detailbutGrid.busy(!0);for(var _$$start=parseInt(_$start),_$$end=parseInt(_$end),empty=[],$itemSplice="this.detailbut.splice(_$$start+1,_$$end-_$$start",i=0;i<_$$end-_$$start;i++)$itemSplice=$itemSplice.concat(",empty");return $itemSplice+=")",eval("("+$itemSplice+")"),void(this.detailbutGrid.resize(_$start)&&this.detailbutGrid.busy(!1))}var searchName=target.substring(target.lastIndexOf(";")+1,target.length),scope=this,doSearch=function(t){og.api.rest.searchtext.get({searchtext:t,stype:"0"}).pipe(function(t){var t=t.data;if($.isArray(t)){var e=t[0][0].code;$("div.modal-backdrop").remove(),scope.$store.commit({type:"passScode",scode:e}),$(".positiondrag").modal("hide"),scope.$router.push({name:"stockInfo"}),e=e.substr(2)+e.substring(0,2);var a=["FKSec",e,searchName,"2"];utils.addLastVisit(a,"recent",function(t){})}})};return void doSearch(searchName)}var sCode=$target.attr("securityid"),sName=$target.html().replace(/&nbsp;/g,"");if(sCode){$("div.modal-backdrop").remove();var _data=sCode.split("~");if(sCode&&sCode.indexOf("~")>-1&&_data){var _scode=_data[1],_scode=_scode.substr(-2)+_scode.substring(0,_scode.length-2);this.$store.commit({type:"passScode",scode:_scode})}common.reqLastVisit(sCode,sName,2,"recent",this.$router)}}}}}).call(exports,__webpack_require__(2))},1136:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"realTime position"},[a("div",{staticClass:"modal fade pas-modal positiondrag",attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"positiondrag_title"}},[a("div",{directives:[{name:"modal-drag",rawName:"v-modal-drag"}],staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"twoselect"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedIndustry,expression:"selectedIndustry"}],staticClass:"industrysel",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selectedIndustry=e.target.multiple?a:a[0]},function(e){t.change(e)}]}},t._l(t.industrysel,function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedBench,expression:"selectedBench"}],staticClass:"namesel",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selectedBench=e.target.multiple?a:a[0]},function(e){t.change(e,"Bench")}]}},t._l(t.namesel,function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))]),t._v(" "),a("div",{staticClass:"detail_table modal-detail",staticStyle:{width:"900px",height:"90%"}},[a("pas-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading4,expression:"loading4"}],attrs:{data:t.detailbut,grid:t.detailbutGrid,"dep-id":"detail-table",width:"900px",height:"calc(90% - 20px)"}},[a("pas-table-column",{attrs:{dep:!1,prop:"name",label:"行业"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"cl_fre_name",staticStyle:{position:"relative"},attrs:{securityid:e.row.data.securityId,title:t._f("securityNameFilter")(e.row.data.name)},domProps:{innerHTML:t._s(e.row.data.name)},on:{click:function(e){t.addVisit(e)}}})]}}])}),t._v(" "),a("pas-table-column",{attrs:{resizable:!1,align:"right",prop:"Position Volume",label:"持仓数量"}}),t._v(" "),a("pas-table-column",{attrs:{resizable:!1,align:"right",prop:"Position Cost",label:"成本"}}),t._v(" "),a("pas-table-column",{attrs:{resizable:!1,align:"right",prop:"Market Value",label:"市值"}}),t._v(" "),a("pas-table-column",{attrs:{resizable:!1,align:"right",prop:"Weight",label:"组合仓位"}}),t._v(" "),a("pas-table-column",{attrs:{resizable:!1,align:"right",prop:"Bench Component Weight",label:t.benchLabel}})],1)],1)])])])]),t._v(" "),a("div",{staticClass:"top-notice"},[t._v("\r\n        当前重仓个股为\r\n        "),a("span",{staticClass:"blue-font",staticStyle:{cursor:"pointer"},attrs:{securityid:t.awkwardness[0].securityId,title:t.awkwardness[0].name},domProps:{innerHTML:t._s(t.awkwardness[0].name)},on:{click:function(e){t.addVisit(e)}}}),t._v("，达到\r\n        "),a("span",{staticClass:"blue-font"},[t._v(t._s(t.awkwardness[0].Weight.value))]),t._v("的仓位;\r\n        重仓行业为\r\n        "),a("span",{staticClass:"blue-font",attrs:{securityid:t.heavyIndustry[0].securityId},domProps:{innerHTML:t._s(t.heavyIndustry[0].name)}}),t._v("，达到\r\n        "),a("span",{staticClass:"blue-font"},[t._v(t._s(t.heavyIndustry[0].Weight.value))]),t._v("的仓位。\r\n    ")]),t._v(" "),a("div",{staticClass:"position_table"},[a("div",{staticClass:"row"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading1,expression:"loading1"}],staticClass:"col-md-6 panel-left"},[a("table",{staticClass:"table-common",attrs:{tabId:"awkwardness"}},[t._m(1),t._v(" "),a("tbody",t._l(t.awkwardness,function(e){return a("tr",{directives:[{name:"show",rawName:"v-show",value:void 0!=e,expression:"item!=undefined"}]},[a("td",{staticClass:"center"},[a("span",{staticClass:"cl_fre_name",staticStyle:{position:"relative",cursor:"pointer"},attrs:{securityid:e.securityId,title:e.name},domProps:{innerHTML:t._s(e.name)},on:{click:function(e){t.addVisit(e)}}},[t._v(t._s(e.name))])]),t._v(" "),e["Position Volume"]?a("td",{staticClass:"right",attrs:{cell:t._f("objToJSONString")(e["Position Volume"])},domProps:{innerHTML:t._s(e["Position Volume"].value)}}):t._e(),t._v(" "),e["Position Cost"]?a("td",{staticClass:"right",attrs:{cell:t._f("objToJSONString")(e["Position Cost"])},domProps:{innerHTML:t._s(e["Position Cost"].value)}}):t._e(),t._v(" "),e["Market Value"]?a("td",{staticClass:"right",attrs:{cell:t._f("objToJSONString")(e["Market Value"])},domProps:{innerHTML:t._s(e["Market Value"].value)}}):t._e(),t._v(" "),e.Weight?a("td",{staticClass:"right",attrs:{cell:t._f("objToJSONString")(e.Weight)},domProps:{innerHTML:t._s(e.Weight.value)}}):t._e()])}))])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticClass:"col-md-6 panel-right"},[a("div",{staticClass:"breakdown"},[a("button",{staticClass:"btn btn-primary break-but",attrs:{type:"button","data-toggle":"modal","data-target":".positiondrag"}},[t._v("明细\r\n                    ")]),t._v(" "),a("table",{staticClass:"table-common",attrs:{tabId:"heavyIndustry"}},[t._m(2),t._v(" "),a("tbody",t._l(t.heavyIndustry,function(e){return a("tr",{directives:[{name:"show",rawName:"v-show",value:void 0!=e,expression:"item!=undefined"}]},[a("td",{staticClass:"center"},[a("span",{staticClass:"cl_fre_name",staticStyle:{position:"relative"},attrs:{securityid:e.securityId,title:e.name},domProps:{innerHTML:t._s(e.name)},on:{click:function(e){t.addVisit(e)}}})]),t._v(" "),e["Position Cost"]?a("td",{staticClass:"right",staticStyle:{position:"relative"},attrs:{cell:t._f("objToJSONString")(e["Position Cost"])},domProps:{innerHTML:t._s(e["Position Cost"].value)}}):t._e(),t._v(" "),e["Market Value"]?a("td",{staticClass:"right",staticStyle:{position:"relative"},attrs:{cell:t._f("objToJSONString")(e["Market Value"])},domProps:{innerHTML:t._s(e["Market Value"].value)}}):t._e(),t._v(" "),e.Weight?a("td",{staticClass:"right",staticStyle:{position:"relative"},attrs:{cell:t._f("objToJSONString")(e.Weight)},domProps:{innerHTML:t._s(e.Weight.value)}}):t._e()])}))])])])])]),t._v(" "),a("div",{staticClass:"panel panel-default"},[t._m(3),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading3,expression:"loading3"}],staticClass:"panel-body"},[a("div",{directives:[{name:"echarts",rawName:"v-echarts"}],staticStyle:{width:"100%",height:"300px"},attrs:{id:"positionAnalysis_chart",config:"echartConfig"}})])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{staticStyle:{"font-size":"21px"},attrs:{"aria-hidden":"true"}},[t._v("×")])]),t._v(" "),a("h4",{staticClass:"modal-title",attrs:{id:"positiondrag_title"}},[t._v("持仓明细")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"left",staticStyle:{"padding-left":"12px"},attrs:{colspan:"5"}},[t._v("前5大重仓股")])]),t._v(" "),a("tr",[a("th",[t._v("证券名称")]),t._v(" "),a("th",[t._v("持仓数量")]),t._v(" "),a("th",[t._v("成本")]),t._v(" "),a("th",[t._v("市值")]),t._v(" "),a("th",[t._v("仓位")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"left",staticStyle:{"padding-left":"12px"},attrs:{colspan:"4"}},[t._v("前5大重仓行业")])]),t._v(" "),a("tr",[a("th",[t._v("行业名称")]),t._v(" "),a("th",[t._v("成本")]),t._v(" "),a("th",[t._v("市值")]),t._v(" "),a("th",[t._v("仓位")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-heading"},[a("div",{staticClass:"panel-title"},[t._v("仓位走势")])])}],n={render:i,staticRenderFns:s};e.a=n}});